<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ game_title }} - {{ company_name }} v1.9</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
        <link href="{{ url_for('static', filename='css/style.css') }}?v=10.9" rel="stylesheet">
</head>
<body>
    <div class="container-fluid">
        <!-- Header -->
        <header class="header-brand">
            <div class="container-fluid">
                <div class="row align-items-center py-3">
                    <div class="col-md-6">
                        <div class="d-flex align-items-center">
                            <div class="brand-logo-container">
                                <i class="fas fa-brain brand-logo-icon" style="font-size: 2.5rem; color: var(--fdj-blue-primary);"></i>
                            </div>
                            <div>
                                <h1 class="brand-title mb-0 game-title">{{ game_title }}</h1>
                                <p class="brand-subtitle mb-0 company-name">{{ company_name }} - HR Managers Edition v1.9</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 text-end">
                        <div class="d-flex justify-content-end align-items-center">
                            <div class="score-display-container">
                                <div class="score-item total-score me-3">
                                    <i class="fas fa-star me-2"></i>
                                    Score Total: <span id="total-score">0</span>/15
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-container">
            <!-- Login Section -->
            <div id="login-section" class="login-container">
                <div class="login-card">
                    <div class="text-center mb-4">
                        <i class="fas fa-brain mb-3" style="font-size: 3rem; color: var(--fdj-blue-primary);"></i>
                        <h2 class="mb-2" style="color: var(--fdj-blue-primary); font-weight: 700;">AI Transformation</h2>
                        <p class="text-muted mb-4">PlayNext - Leader Edition v1.9</p>
                    </div>
                    
                    <!-- Alert Messages -->
                    <div id="login-alert" class="alert alert-dismissible fade" role="alert" style="display: none;">
                        <span id="login-alert-message"></span>
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                    
                    <form id="login-form" novalidate>
                        <div class="mb-4">
                        <label for="username" class="form-label">
                            <i class="fas fa-user me-2"></i>Username
                        </label>
                        <input type="text" class="form-control" id="username" placeholder="Enter your username" required minlength="2" maxlength="50">
                        <div class="invalid-feedback" id="username-error"></div>
                        <div class="form-text">Minimum 2 characters, maximum 50 characters</div>
                        </div>
                        <div class="mb-4">
                            <label for="password" class="form-label">
                                <i class="fas fa-lock me-2"></i>Password
                            </label>
                            <input type="password" class="form-control" id="password" placeholder="Enter your password" required minlength="6">
                            <div class="invalid-feedback" id="password-error"></div>
                            <div class="form-text">Minimum 6 characters</div>
                        </div>
                        <button type="submit" class="btn btn-primary w-100" id="login-submit-btn">
                            <span id="login-btn-text">
                                <i class="fas fa-sign-in-alt me-2"></i>Sign In
                            </span>
                            <span id="login-btn-loading" style="display: none;">
                                <i class="fas fa-spinner fa-spin me-2"></i>Signing in...
                            </span>
                        </button>
                    </form>
                    
                    <!-- Login Info -->
                    <div class="mt-4 text-center">
                        <small class="text-muted">
                            <i class="fas fa-shield-alt me-1"></i>
                            Accès sécurisé - Utilisateurs autorisés uniquement
                        </small>
                    </div>
                </div>
            </div>

            <!-- Video Introduction -->
            <div id="video-intro-section" class="card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-video me-2"></i>Introduction Video</h3>
                </div>
                <div class="card-body">
                    <div class="video-container mb-4">
                        <div class="embed-responsive embed-responsive-16by9">
                            <video 
                                id="intro-video"
                                class="embed-responsive-item" 
                                controls
                                autoplay
                                playsinline
                                style="width: 100%; height: 100%; border-radius: 15px;">
                                <source src="{{ url_for('static', filename='videos/presentation_serious_game.mp4') }}" type="video/mp4">
                                Votre navigateur ne supporte pas la lecture vidéo.
                            </video>
                        </div>
                    </div>
                    <div class="text-center">
                        <button id="skip-video-btn" class="btn btn-outline-primary me-3">
                            <i class="fas fa-forward me-2"></i>Skip Video
                        </button>
                        <button id="start-game-btn" class="btn btn-primary btn-lg" style="display: none;">
                            <i class="fas fa-play me-2"></i>Start Game
                        </button>
                    </div>
                </div>
            </div>

            <!-- Game Introduction -->
            <div id="game-intro" class="card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-rocket me-2"></i>Introduction au Jeu</h3>
                </div>
                <div class="card-body">
                    <div id="intro-text" class="mb-4"></div>
                    <div class="text-center">
                        <button id="next-to-harnessing-btn" class="btn btn-primary btn-lg">
                            <i class="fas fa-play me-2"></i>Start Game
                        </button>
                    </div>
                </div>
            </div>

            <!-- Phase1 Video Section -->
            <div id="phase1-video-section" class="card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-video me-2"></i>{{ template.get_phase_title('phase1') }}</h3>
                </div>
                <div class="card-body">
                    <div class="video-container mb-4">
                        <div class="embed-responsive embed-responsive-16by9">
                            <video 
                                id="phase1-video"
                                class="embed-responsive-item" 
                                controls
                                autoplay
                                playsinline
                                style="width: 100%; height: 100%; border-radius: 15px;">
                                <source src="{{ url_for('static', filename='videos/phase_1.mp4') }}" type="video/mp4">
                                Votre navigateur ne supporte pas la lecture vidéo.
                            </video>
                        </div>
                    </div>
                    <div class="text-center">
                        <button id="continue-after-phase1-video-btn" class="btn btn-primary btn-lg">
                            <i class="fas fa-forward me-2"></i>Continue
                        </button>
                    </div>
                </div>
            </div>

            <!-- Phase2 Video Section -->
            <div id="phase2-video-section" class="card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-video me-2"></i>{{ template.get_phase_title('phase2') }}</h3>
                </div>
                <div class="card-body">
                    <div class="video-container mb-4">
                        <div class="embed-responsive embed-responsive-16by9">
                            <video 
                                id="phase2-video"
                                class="embed-responsive-item" 
                                controls
                                autoplay
                                playsinline
                                style="width: 100%; height: 100%; border-radius: 15px;">
                                <source src="{{ url_for('static', filename='videos/phase_2.mp4') }}" type="video/mp4">
                                Votre navigateur ne supporte pas la lecture vidéo.
                            </video>
                        </div>
                    </div>
                    <div class="text-center">
                        <button id="continue-after-phase2-video-btn" class="btn btn-primary btn-lg">
                            <i class="fas fa-forward me-2"></i>Continue
                        </button>
                    </div>
                </div>
            </div>

            <!-- Phase3 Video Section -->
            <div id="phase3-video-section" class="card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-video me-2"></i>{{ template.get_phase_title('phase3') }}</h3>
                </div>
                <div class="card-body">
                    <div class="video-container mb-4">
                        <div class="embed-responsive embed-responsive-16by9">
                            <video 
                                id="phase3-video"
                                class="embed-responsive-item" 
                                controls
                                autoplay
                                playsinline
                                style="width: 100%; height: 100%; border-radius: 15px;">
                                <source src="{{ url_for('static', filename='videos/phase_3.mp4') }}" type="video/mp4">
                                Votre navigateur ne supporte pas la lecture vidéo.
                            </video>
                        </div>
                    </div>
                    <div class="text-center">
                        <button id="continue-after-phase3-video-btn" class="btn btn-primary btn-lg">
                            <i class="fas fa-forward me-2"></i>Continue
                        </button>
                    </div>
                </div>
            </div>

            <!-- Phase4 Video Section -->
            <div id="phase4-video-section" class="card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-video me-2"></i>{{ template.get_phase_title('phase4') }}</h3>
                </div>
                <div class="card-body">
                    <div class="video-container mb-4">
                        <div class="embed-responsive embed-responsive-16by9">
                            <video 
                                id="phase4-video"
                                class="embed-responsive-item" 
                                controls
                                autoplay
                                playsinline
                                style="width: 100%; height: 100%; border-radius: 15px;">
                                <source src="{{ url_for('static', filename='videos/phase_4.mp4') }}" type="video/mp4">
                                Votre navigateur ne supporte pas la lecture vidéo.
                            </video>
                        </div>
                    </div>
                    <div class="text-center">
                        <button id="continue-after-phase4-video-btn" class="btn btn-primary btn-lg">
                            <i class="fas fa-forward me-2"></i>Continue
                        </button>
                    </div>
                </div>
            </div>

            <!-- Phase5-1 Video Section -->
            <div id="phase5-1-video-section" class="card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-video me-2"></i>{{ template.get_phase_title('phase5') }}</h3>
                </div>
                <div class="card-body">
                    <div class="video-container mb-4">
                        <div class="embed-responsive embed-responsive-16by9">
                            <video 
                                id="phase5-1-video"
                                class="embed-responsive-item" 
                                controls
                                autoplay
                                playsinline
                                style="width: 100%; height: 100%; border-radius: 15px;">
                                <source src="{{ url_for('static', filename='videos/phase_5_1.mp4') }}" type="video/mp4">
                                Votre navigateur ne supporte pas la lecture vidéo.
                            </video>
                        </div>
                    </div>
                    <div class="text-center">
                        <button id="call-after-phase5-1-video-btn" class="btn btn-success btn-lg">
                            <i class="fas fa-phone me-2"></i>Call
                        </button>
                    </div>
                </div>
            </div>

            <!-- Phase5-2 Video Section -->
            <div id="phase5-2-video-section" class="card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-video me-2"></i>{{ template.get_phase_title('phase5') }}</h3>
                </div>
                <div class="card-body">
                    <div class="video-container mb-4">
                        <div class="embed-responsive embed-responsive-16by9">
                            <video 
                                id="phase5-2-video"
                                class="embed-responsive-item" 
                                controls
                                autoplay
                                playsinline
                                style="width: 100%; height: 100%; border-radius: 15px;">
                                <source src="{{ url_for('static', filename='videos/phase_5_2.mp4') }}" type="video/mp4">
                                Votre navigateur ne supporte pas la lecture vidéo.
                            </video>
                        </div>
                    </div>
                    <div class="text-center">
                        <button id="continue-after-phase5-2-video-btn" class="btn btn-primary btn-lg">
                            <i class="fas fa-forward me-2"></i>Continue
                        </button>
                    </div>
                </div>
            </div>

            <!-- Recap Video Section -->
            <div id="recap-video-section" class="card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-video me-2"></i>Game Recap</h3>
                </div>
                <div class="card-body">
                    <div class="video-container mb-4">
                        <div class="embed-responsive embed-responsive-16by9">
                            <video 
                                id="recap-video"
                                class="embed-responsive-item" 
                                controls
                                autoplay
                                playsinline
                                style="width: 100%; height: 100%; border-radius: 15px;">
                                <source src="{{ url_for('static', filename='videos/recap.mp4') }}" type="video/mp4">
                                Votre navigateur ne supporte pas la lecture vidéo.
                            </video>
                        </div>
                    </div>
                    <div class="text-center">
                        <button id="finish-game-btn" class="btn btn-success btn-lg">
                            <i class="fas fa-check-circle me-2"></i>Finish Game
                        </button>
                    </div>
                </div>
            </div>

            <!-- Welcome Page Section -->
            <div id="welcome-section" class="welcome-page" style="display: none;">
                <div class="welcome-content">
                    <div class="welcome-frame">
                        <h3><i class="fas fa-handshake"></i>Welcome!</h3>
                        <p class="welcome-text">
                            Welcome ! You are the AI Transformation Leader at PlayNext, a leading gaming company with 1 800 employees worldwide. Facing fast-moving competition and evolving player expectations, the company must reinvent how it creates, delivers, and scales innovation.
                            <br><br>
                            Your mission: define how AI can accelerate creativity and performance — without compromising the culture, values, and human spirit that make PlayNext unique.
                        </p>
                        <button id="continue-welcome-btn" class="btn btn-light btn-lg">
                            <i class="fas fa-arrow-right me-2"></i>Continue
                        </button>
                    </div>
                </div>
            </div>

            <!-- Pilot Phase Transition Section -->
            <div id="pilot-phase-section" class="welcome-page" style="display: none;">
                <div class="welcome-content">
                    <div class="welcome-frame">
                        <h3><i class="fas fa-rocket"></i>Pilot Step</h3>
                        <p class="welcome-text" id="pilot-phase-text">
                            The three selected projects — Smart Game Design Assistant, Player Journey Optimizer, and Fraud & Integrity Detection — are now moving into pilot phase. Each team has begun working with vendors, datasets, and internal champions.
                            <br><br>
                            Sophie's next challenge is to ensure that these pilots not only deliver results but also inspire adoption across the company. To do this, she must choose the right enablers — initiatives that accelerate transformation, build trust, and make change sustainable.
                        </p>
                        <button id="continue-pilot-phase-btn" class="btn btn-light btn-lg">
                            <i class="fas fa-arrow-right me-2"></i>Continue
                        </button>
                    </div>
                </div>
            </div>

            <!-- Scaling Phase Transition Section -->
            <div id="scaling-phase-section" class="welcome-page" style="display: none;">
                <div class="welcome-content">
                    <div class="welcome-frame">
                        <h3><i class="fas fa-building"></i>Enterprise Scaling</h3>
                        <p class="welcome-text" id="scaling-phase-text">
                            After several months of scaling, AI and GenAI are now part of PlayNext's daily rhythm.
                            <br><br>
                            The company's success has caught the attention of the executive committee — who now want to accelerate even further, extending AI across all studios, markets, and business functions.
                            <br><br>
                            Sophie faces a new challenge: scaling not just systems, but capabilities — data, skills, governance, and partnerships — to make AI truly enterprise-wide.
                        </p>
                        <button id="continue-scaling-phase-btn" class="btn btn-light btn-lg">
                            <i class="fas fa-arrow-right me-2"></i>Continue
                        </button>
                    </div>
                </div>
            </div>

            <!-- Harnessing Video Section -->
            <div id="harnessing-video-section" class="card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-video me-2"></i>Introduction</h3>
                </div>
                <div class="card-body">
                    <div class="video-container mb-4">
                        <div class="embed-responsive embed-responsive-16by9">
                            <video 
                                id="harnessing-video"
                                class="embed-responsive-item" 
                                controls
                                autoplay
                                playsinline
                                style="width: 100%; height: 100%; border-radius: 15px;">
                                <source src="{{ url_for('static', filename='videos/Introduction.mp4') }}" type="video/mp4">
                                Votre navigateur ne supporte pas la lecture vidéo.
                            </video>
                        </div>
                    </div>
                    <div class="text-center">
                        <button id="skip-harnessing-btn" class="btn btn-outline-primary me-3">
                            <i class="fas fa-forward me-2"></i>Continue
                        </button>
                        <button id="start-game-after-harnessing-btn" class="btn btn-primary" style="display: none;">
                            <i class="fas fa-play me-2"></i>Start Game
                        </button>
                    </div>
                </div>
            </div>

            <!-- Teams Meeting Introduction Section -->
            <div id="teams-meeting-section" class="welcome-page" style="display: none;">
                <div class="welcome-content">
                    <div class="welcome-frame">
                        <h3><i class="fas fa-users"></i>Teams Meeting</h3>
                        <p class="welcome-text">
                            Sophie is now organizing a strategy workshop with three key stakeholders — the CIO, the Strategy & Change Director, and the Marketing & Player Experience Director — to define how AI should be integrated into the company's innovation and production model.
                        </p>
                        <button id="join-teams-meeting-btn" class="btn btn-primary btn-lg">
                            <i class="fas fa-video me-2"></i>Join Teams meeting
                        </button>
                    </div>
                </div>
            </div>

            <!-- Step 1 Follow-up Introduction Section -->
            <div id="step1-followup-section" class="welcome-page" style="display: none;">
                <div class="welcome-content">
                    <div class="welcome-frame">
                        <h3><i class="fas fa-chart-line"></i>Strategic Assessment Complete</h3>
                        <p class="welcome-text">
                            Following the first strategic discussions, Sophie has chosen a value-driven approach with Elena. Over the past weeks, the AI team has assessed potential opportunities across production, marketing, operations, and player engagement.<br><br>
                            Now Marcus expects Sophie to present the most promising use cases — the ones that deliver measurable impact quickly, with reasonable effort and manageable risk. Your objective is to prioritize where AI can create visible value while keeping complexity under control.
                        </p>
                        <button id="continue-to-step2-btn" class="btn btn-primary btn-lg">
                            <i class="fas fa-arrow-right me-2"></i>Continue to Step 2
                        </button>
                    </div>
                </div>
            </div>



            <!-- Phase 1: Character Selection with Accordion -->
            <div id="phase1-section" class="phase-section card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-users me-2"></i>{{ template.get_phase_title('phase1') }}</h3>
                </div>
                <div class="card-body">
                    <div class="alert alert-info mb-4" style="background: rgba(13, 202, 240, 0.1); border: 1px solid rgba(13, 202, 240, 0.3); border-radius: 12px;">
                        <div class="d-flex align-items-start">
                            <i class="fas fa-info-circle me-3 mt-1" style="color: #0dcaf0; font-size: 1.2rem;"></i>
                            <div>
                                <h5 class="alert-heading mb-2" style="color: #0dcaf0;">Briefing</h5>
                                <p class="mb-0" style="color: #0a58ca; font-size: 1.1rem; line-height: 1.5;">
                                    {{ template.get_phase_description('phase1') }}
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div id="phase1-choices" class="accordion-container">
                        <!-- Les choix accordéon seront générés ici -->
                    </div>
                    
                    <div class="mt-4 text-center">
                        <button id="phase1-confirm-btn" class="btn btn-primary" disabled>
                            <i class="fas fa-check me-2"></i>Confirm Selection
                        </button>
                    </div>
                </div>
            </div>

            <!-- Phase 2: Portfolio Selection with Drag & Drop -->
            <div id="phase2-section" class="phase-section card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-chart-line me-2"></i>{{ template.get_phase_title('phase2') }}</h3>
                </div>
                <div class="card-body">
                    <div class="alert alert-info mb-4" style="background: rgba(13, 202, 240, 0.1); border: 1px solid rgba(13, 202, 240, 0.3); border-radius: 12px;">
                        <div class="d-flex align-items-start">
                            <i class="fas fa-info-circle me-3 mt-1" style="color: #0dcaf0; font-size: 1.2rem;"></i>
                            <div>
                                <h5 class="alert-heading mb-2" style="color: #0dcaf0;">Briefing</h5>
                                <p class="mb-0" style="color: #0a58ca; font-size: 1.1rem; line-height: 1.5;">
                                    {{ template.get_phase_description('phase2') }}
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-8">
                            <!-- Impact/Feasibility Matrix -->
                            <div class="matrix-section mb-4">
                                <h5 class="mb-3"><i class="fas fa-chart-line me-2 text-primary"></i>Impact vs Feasibility Matrix</h5>
                                <div id="impact-feasibility-matrix" class="impact-feasibility-matrix">
                                    <!-- Matrix will be generated here -->
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <h5 class="mb-3"><i class="fas fa-arrow-up me-2 text-success"></i>Top 3 Priorities (Drag & Drop)</h5>
                            <div id="phase2-priorities" class="priorities-container mb-4">
                                <div class="priority-slot" data-slot="1">
                                    <div class="priority-placeholder">
                                        <i class="fas fa-plus-circle me-2"></i>Priority 1
                                    </div>
                                </div>
                                <div class="priority-slot" data-slot="2">
                                    <div class="priority-placeholder">
                                        <i class="fas fa-plus-circle me-2"></i>Priority 2
                                    </div>
                                </div>
                                <div class="priority-slot" data-slot="3">
                                    <div class="priority-placeholder">
                                        <i class="fas fa-plus-circle me-2"></i>Priority 3
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Available Solutions - Full Width -->
                    <div class="row">
                        <div class="col-12">
                            <h5 class="mb-3"><i class="fas fa-list me-2 text-info"></i>Available Solutions</h5>
                            <div id="phase2-choices" class="available-solutions-full">
                                <!-- Les cartes de solutions seront générées ici -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4 text-center">
                        <span id="phase2-selected-count" class="badge me-3">0/3 selected</span>
                        <button id="phase2-confirm-btn" class="btn btn-primary" disabled onclick="gameController.confirmPhase2Choices()">
                            <i class="fas fa-check me-2"></i>Confirm Selection
                        </button>
                    </div>
                </div>
            </div>

            <!-- Phase 3: Enabler Selection with 3x3 Matrix -->
            <div id="phase3-section" class="phase-section card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-cogs me-2"></i>{{ template.get_phase_title('phase3') }}</h3>
                </div>
                <div class="card-body">
                    <div class="alert alert-info mb-4" style="background: rgba(13, 202, 240, 0.1); border: 1px solid rgba(13, 202, 240, 0.3); border-radius: 12px;">
                        <div class="d-flex align-items-start">
                            <i class="fas fa-info-circle me-3 mt-1" style="color: #0dcaf0; font-size: 1.2rem;"></i>
                            <div>
                                <h5 class="alert-heading mb-2" style="color: #0dcaf0;">Briefing</h5>
                                <p class="mb-0" style="color: #0a58ca; font-size: 1.1rem; line-height: 1.5;">
                                    You can only activate one enabler per domain to maximize impact and adoption. Which ones will you choose?
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-9">
                            <h5 class="mb-3"><i class="fas fa-th me-2 text-primary"></i>Select 1 enabler per category:</h5>
                            <div id="phase3-choices" class="matrix-container">
                                <!-- La matrice 3x3 sera générée ici -->
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="progress-sidebar">
                                <h6 class="text-center mb-3"><i class="fas fa-chart-bar me-2"></i>Progress</h6>
                                <div class="progress-bar-vertical">
                                    <div class="progress-step" data-step="1">
                                        <div class="step-indicator"></div>
                                        <span class="step-label">1</span>
                                    </div>
                                    <div class="progress-step" data-step="2">
                                        <div class="step-indicator"></div>
                                        <span class="step-label">2</span>
                                    </div>
                                    <div class="progress-step" data-step="3">
                                        <div class="step-indicator"></div>
                                        <span class="step-label">3</span>
                                    </div>
                                </div>
                                <div class="progress-text text-center mt-3">
                                    <span id="phase3-progress-text">0/3 selected</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4 text-center">
                        <button id="phase3-confirm-btn" class="btn btn-primary" disabled>
                            <i class="fas fa-check me-2"></i>Confirm Selection
                        </button>
                    </div>
                </div>
            </div>

            <!-- Phase 4: Budget Selection with 3x3 Matrix -->
            <div id="phase4-section" class="phase-section card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-coins me-2"></i>{{ template.get_phase_title('phase4') }}</h3>
                </div>
                <div class="card-body">
                    <div class="alert alert-info mb-4" style="background: rgba(13, 202, 240, 0.1); border: 1px solid rgba(13, 202, 240, 0.3); border-radius: 12px;">
                        <div class="d-flex align-items-start">
                            <i class="fas fa-info-circle me-3 mt-1" style="color: #0dcaf0; font-size: 1.2rem;"></i>
                            <div>
                                <h5 class="alert-heading mb-2" style="color: #0dcaf0;">Briefing</h5>
                                <p class="mb-0" style="color: #0a58ca; font-size: 1.1rem; line-height: 1.5;">
                                    You now have a better idea of what needs to be done to scale AI solutions. It's time to make a decision.<br>
                                    Select the most impactful and timely enablers within your 30-point budget that will allow you to successfully scale your AI solutions to continue accelerating value delivery. Don't forget you need to balance between different categories.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-9">
                            <h5 class="mb-3"><i class="fas fa-th me-2 text-primary"></i>Select enablers (max 30 points):</h5>
                            <div id="phase4-choices" class="matrix-container">
                                <!-- La matrice 3x3 sera générée ici -->
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="budget-sidebar">
                                <h6 class="text-center mb-3"><i class="fas fa-chart-bar me-2"></i>Budget</h6>
                                <div class="budget-bar-vertical">
                                    <div class="budget-indicator">
                                        <div class="budget-fill" id="budget-fill"></div>
                                    </div>
                                    <div class="budget-labels">
                                        <span class="budget-label budget-label-0">0</span>
                                        <span class="budget-label budget-label-30">30</span>
                                    </div>
                                </div>
                                <div class="budget-text text-center mt-3">
                                    <span id="phase4-budget-display">0/30 points</span>
                                </div>
                                <div class="budget-status text-center mt-2">
                                    <span id="budget-status" class="badge badge-secondary">Select enablers</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4 text-center">
                        <button id="phase4-confirm-btn" class="btn btn-primary" disabled>
                            <i class="fas fa-check me-2"></i>Confirm Selection
                        </button>
                    </div>
                </div>
            </div>

            <!-- Phase 5: Final Selection -->
            <div id="phase5-section" class="phase-section card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-flag-checkered me-2"></i>{{ template.get_phase_title('phase5') }}</h3>
                </div>
                <div class="card-body">
                    <div class="alert alert-info mb-4" style="background: rgba(13, 202, 240, 0.1); border: 1px solid rgba(13, 202, 240, 0.3); border-radius: 12px;">
                        <div class="d-flex align-items-start">
                            <i class="fas fa-info-circle me-3 mt-1" style="color: #0dcaf0; font-size: 1.2rem;"></i>
                            <div>
                                <h5 class="alert-heading mb-2" style="color: #0dcaf0;">Briefing</h5>
                                <p class="mb-0" style="color: #0a58ca; font-size: 1.1rem; line-height: 1.5;">
                                    It's time to launch and scale more solutions at the enterprise level. Let's decide what actions to take!<br>
                                    Select the option that will maximize your chances of bringing the most new scaled solutions to market. Consider what you need most at this stage of transformation to scale effectively.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div id="phase5-choices" class="accordion-container">
                        <!-- Les choix accordéon seront générés ici -->
                    </div>
                    
                    <div class="mt-4 text-center">
                        <button id="phase5-confirm-btn" class="btn btn-primary" disabled>
                            <i class="fas fa-check me-2"></i>Confirm Selection
                        </button>
                    </div>
                </div>
            </div>

            <!-- Results -->
            <div id="results-section" class="card mb-4" style="display: none;">
                <div class="card-header">
                    <h3><i class="fas fa-trophy me-2"></i>Résultats</h3>
                </div>
                <div class="card-body text-center">
                    <div id="results-content"></div>
                    <button id="play-again-btn" class="btn btn-primary btn-lg mt-4">
                        <i class="fas fa-redo me-2"></i>Replay
                    </button>
                </div>
            </div>

            <!-- Score Display -->
            <div class="card mb-4" style="display: none;" id="score-display-card">
                <div class="card-header">
                    <h5><i class="fas fa-star me-2"></i>Score Actuel</h5>
                </div>
                <div class="card-body">
                    <div id="score-display" class="text-center">
                        <div class="row">
                            <div class="col-md-2">
                                <div class="score-item">
                                    <strong>Phase1</strong><br>
                                    <span id="phase1-score" class="score-value">-</span>/3
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="score-item">
                                    <strong>Phase2</strong><br>
                                    <span id="phase2-score" class="score-value">-</span>/3
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="score-item">
                                    <strong>Phase3</strong><br>
                                    <span id="phase3-score" class="score-value">-</span>/3
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="score-item">
                                    <strong>Phase4</strong><br>
                                    <span id="phase4-score" class="score-value">-</span>/3
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="score-item">
                                    <strong>Phase5</strong><br>
                                    <span id="phase5-score" class="score-value">-</span>/3
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="score-item total-score">
                                    <strong>TOTAL</strong><br>
                                    <span id="total-score" class="score-value">0</span>/15
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Progress Bar -->
            <div class="card mb-4" style="display: none;" id="progress-card">
                <div class="card-body">
                    <h5><i class="fas fa-tasks me-2"></i>Progress</h5>
                    <div class="progress">
                        <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 0%"></div>
                    </div>
                    <div id="progress-text" class="mt-3 text-center">Ready to start</div>
                </div>
            </div>
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div class="modal fade" id="loadingModal" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="border-radius: 20px; border: none; box-shadow: 0 20px 60px rgba(30, 58, 138, 0.3);">
                <div class="modal-body text-center py-5">
                    <div class="spinner-border text-primary mb-4" style="width: 3rem; height: 3rem;" role="status">
                        <span class="visually-hidden">Chargement...</span>
                    </div>
                    <h5 class="mb-3" style="color: var(--fdj-blue-primary);">Chargement...</h5>
                    <p class="text-muted mb-4">Préparation de votre expérience de jeu</p>
                    <button type="button" class="btn btn-outline-secondary" onclick="gameController.forceCloseModal()">
                        <i class="fas fa-times me-2"></i>Fermer si bloqué
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Score Screen Modal (Original Fullscreen) -->
    <div class="modal fade" id="scoreModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-body p-0">
                    <div class="score-screen-content">
                        <div class="score-header">
                            <div class="moment-score-label">STEP SCORE</div>
                            <div class="moment-title" id="current-mot-title">{{ template.get_phase_title('phase1') }}</div>
                        </div>
                        
                        <div class="score-display-large">
                            <h1 class="score-title">Your score</h1>
                            
                            <div class="score-stars" id="score-stars-container">
                                <!-- Stars will be populated here -->
                            </div>
                            
                            <div class="score-message">
                                <p id="score-description"></p>
                            </div>
                        </div>
                        
                        
                        <div class="score-footer">
                            <button type="button" class="btn btn-primary btn-lg" id="score-next-btn">NEXT</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Executive Dashboard Modal -->
    <div class="modal fade" id="executiveDashboardModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-body p-0">
                    <div class="executive-dashboard">
                        <!-- Header -->
                        <div class="dashboard-header">
                                    <div class="dashboard-title">
                                        <h1><i class="fas fa-chart-line me-3"></i>{{ template.get_dashboard_title() }}</h1>
                                        <p class="dashboard-subtitle">{{ template.get_dashboard_subtitle() }}</p>
                                    </div>
                            <div class="current-phase-info">
                                <div class="phase-label" id="current-phase-label">STEP SCORE</div>
                                <div class="phase-title" id="current-phase-title">AI HR Transformation</div>
                            </div>
                        </div>
                        
                        <!-- Main Dashboard Content -->
                        <div class="dashboard-content">
                            <!-- Top Section: Score, Progress, Impact -->
                            <div class="dashboard-top-section">
                                <div class="row g-4">
                                    <!-- Current Score -->
                                    <div class="col-md-4">
                                        <div class="score-section">
                                            <h2><i class="fas fa-star me-2"></i>Current Score</h2>
                                            <div class="score-display">
                                                <div class="score-total">
                                                    <span class="score-number" id="dashboard-total-score">0</span>
                                                    <span class="score-max">/15</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Step Progress -->
                                    <div class="col-md-4">
                                        <div class="progress-section">
                                            <h3><i class="fas fa-tasks me-2"></i>Step Progress</h3>
                                            <div class="mot-squares" id="mot-squares">
                                                <div class="mot-square" id="phase1-square">1</div>
                                                <div class="mot-square" id="phase2-square">2</div>
                                                <div class="mot-square" id="phase3-square">3</div>
                                                <div class="mot-square" id="phase4-square">4</div>
                                                <div class="mot-square" id="phase5-square">5</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Educational Impact -->
                                    <div class="col-md-4">
                                        <div class="impact-section">
                                            <h3><i class="fas fa-lightbulb me-2"></i>Educational Impact</h3>
                                            <div class="impact-message" id="impact-message">
                                                <!-- Impact message will be populated here -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Bottom Section: ENABLERS by Step and Category -->
                            <div class="dashboard-bottom-section">
                                <h2><i class="fas fa-cogs me-2"></i>ENABLERS Progress by Step</h2>
                                <div class="pedagogical-grid">
                    <!-- Step Headers -->
                    <div class="phase-headers">
                        <div class="category-header"></div>
                        <div class="phase-header phase-header-1">{{ template.get_terminology('phase') }} 1</div>
                        <div class="phase-header phase-header-2">{{ template.get_terminology('phase') }} 2</div>
                        <div class="phase-header phase-header-3">{{ template.get_terminology('phase') }} 3</div>
                        <div class="phase-header phase-header-4">{{ template.get_terminology('phase') }} 4</div>
                        <div class="phase-header phase-header-5">{{ template.get_terminology('phase') }} 5</div>
                    </div>
                                    
                                    <!-- Category Rows -->
                                    <div class="pedagogical-categories" id="pedagogical-categories">
                                        <!-- Pedagogical data will be populated here -->
                                    </div>
                                    
                                    <!-- Use Cases Section -->
                                    <div id="use-cases-section" class="dashboard-section" style="display: none;">
                                        <h3 class="dashboard-section-title">
                                            <i class="fas fa-lightbulb me-2"></i>Use Cases
                                        </h3>
                                        <div id="use-cases-content" class="use-cases-content">
                                            <!-- Use Cases will be populated here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Footer -->
                        <div class="dashboard-footer">
                            <button id="dashboard-next-button" class="btn btn-primary btn-lg">
                                <i class="fas fa-forward me-2"></i>NEXT
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Alert Container -->
    <div id="alert-container" class="position-fixed top-0 end-0 p-3" style="z-index: 1050;"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="{{ url_for('static', filename='js/game.js') }}?v=2.62&t={{ range(1000000, 9999999) | random }}"></script>
</body>
</html>
